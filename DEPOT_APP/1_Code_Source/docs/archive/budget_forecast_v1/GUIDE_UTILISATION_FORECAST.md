# Guide d'Utilisation du Forecast BudgÃ©taire

## ğŸ¯ Comment accÃ©der au Forecast dans l'application

### Ã‰tape 1: AccÃ©der Ã  la page Budgets
1. Connectez-vous Ã  l'application
2. Dans le menu latÃ©ral, cliquez sur **"Budgets"**
3. Vous verrez la liste de vos budgets sous forme de cartes

### Ã‰tape 2: Cliquer sur le bouton Forecast
Sur chaque carte de budget, vous verrez un bouton **"Forecast"** avec une icÃ´ne ğŸ“ˆ (TrendingUp):

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Budget 2025 - Version 1                â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚                                          â”‚
â”‚  Revenus:      1 500 000 â‚¬              â”‚
â”‚  Charges:      1 200 000 â‚¬              â”‚
â”‚  RÃ©sultat Net:   300 000 â‚¬              â”‚
â”‚                                          â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚  CrÃ©Ã© le 04/01/2025                      â”‚
â”‚                                          â”‚
â”‚                     [ğŸ“ˆ Forecast] [âœï¸ Modifier] â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Ã‰tape 3: Visualiser le Forecast
AprÃ¨s avoir cliquÃ© sur **"Forecast"**, vous accÃ©dez Ã  une nouvelle vue avec:

## ğŸ“Š Les 5 KPI en haut de page

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   RÃ©el YTD   â”‚Budget Annuel â”‚Forecast EOY  â”‚    Ã‰cart     â”‚  Taux Abs.   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  450 000 â‚¬   â”‚ 1 500 000 â‚¬  â”‚ 1 520 000 â‚¬  â”‚ +20 000 â‚¬    â”‚    30%       â”‚
â”‚              â”‚              â”‚              â”‚   (+1.3%)    â”‚              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Explication des KPI**:
- **RÃ©el YTD**: Montant rÃ©alisÃ© depuis le dÃ©but de l'annÃ©e (Year To Date)
- **Budget Annuel**: Budget total prÃ©vu pour l'annÃ©e
- **Forecast EOY**: PrÃ©vision d'atterrissage fin d'annÃ©e (End Of Year)
- **Ã‰cart**: DiffÃ©rence entre forecast et budget (montant et %)
- **Taux Absorption**: RÃ©alisÃ© / Budget (en %)

## ğŸ” Les 3 Modes de Visualisation

### Mode 1: Vue "Totaux" (par dÃ©faut)

Affiche 4 blocs agrÃ©gÃ©s:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ’° REVENUS                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ RÃ©el YTD:        450 000 â‚¬          â”‚
â”‚ Budget Annuel: 1 500 000 â‚¬          â”‚
â”‚ Forecast EOY:  1 520 000 â‚¬          â”‚
â”‚ Ã‰cart:          +20 000 â‚¬ (+1.3%)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“‰ CHARGES                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ RÃ©el YTD:        380 000 â‚¬          â”‚
â”‚ Budget Annuel: 1 200 000 â‚¬          â”‚
â”‚ Forecast EOY:  1 180 000 â‚¬          â”‚
â”‚ Ã‰cart:          -20 000 â‚¬ (-1.7%)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ—ï¸ INVESTISSEMENTS                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ RÃ©el YTD:         30 000 â‚¬          â”‚
â”‚ Budget Annuel:   150 000 â‚¬          â”‚
â”‚ Forecast EOY:    145 000 â‚¬          â”‚
â”‚ Ã‰cart:           -5 000 â‚¬ (-3.3%)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“Š RÃ‰SULTAT NET                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ RÃ©el YTD:         40 000 â‚¬          â”‚
â”‚ Budget Annuel:   150 000 â‚¬          â”‚
â”‚ Forecast EOY:    195 000 â‚¬          â”‚
â”‚ Ã‰cart:          +45 000 â‚¬ (+30%)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Mode 2: Vue "Par CatÃ©gorie"

DÃ©tail par catÃ©gorie budgÃ©taire:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ CATÃ‰GORIE          â”‚ RÃ©el YTD â”‚ Budget   â”‚ Forecast â”‚ Ã‰cart       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ’° REVENUS                                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Ventes             â”‚ 300 000â‚¬ â”‚ 900 000â‚¬ â”‚ 910 000â‚¬ â”‚ +10 000â‚¬    â”‚
â”‚ Prestations        â”‚ 150 000â‚¬ â”‚ 600 000â‚¬ â”‚ 610 000â‚¬ â”‚ +10 000â‚¬    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ“‰ CHARGES                                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Salaires           â”‚ 250 000â‚¬ â”‚ 800 000â‚¬ â”‚ 780 000â‚¬ â”‚ -20 000â‚¬    â”‚
â”‚ Loyers             â”‚  80 000â‚¬ â”‚ 240 000â‚¬ â”‚ 240 000â‚¬ â”‚       0â‚¬    â”‚
â”‚ Marketing          â”‚  50 000â‚¬ â”‚ 160 000â‚¬ â”‚ 160 000â‚¬ â”‚       0â‚¬    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Mode 3: Vue "Mois par Mois"

Vision mensuelle complÃ¨te:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ MOIS       â”‚  RÃ©el    â”‚  Budget  â”‚ Forecast â”‚ Ã‰cart     â”‚ Statut â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Janvier    â”‚ 120 000â‚¬ â”‚ 125 000â‚¬ â”‚ 120 000â‚¬ â”‚ -5 000â‚¬   â”‚ âœ… PassÃ©â”‚
â”‚ FÃ©vrier    â”‚ 110 000â‚¬ â”‚ 125 000â‚¬ â”‚ 110 000â‚¬ â”‚-15 000â‚¬   â”‚ âœ… PassÃ©â”‚
â”‚ Mars       â”‚ 130 000â‚¬ â”‚ 125 000â‚¬ â”‚ 130 000â‚¬ â”‚ +5 000â‚¬   â”‚ âœ… PassÃ©â”‚
â”‚ Avril      â”‚  90 000â‚¬ â”‚ 125 000â‚¬ â”‚ 115 000â‚¬ â”‚-10 000â‚¬   â”‚ ğŸ”µ En coursâ”‚
â”‚ Mai        â”‚       0â‚¬ â”‚ 125 000â‚¬ â”‚ 125 000â‚¬ â”‚      0â‚¬   â”‚ â³ Futurâ”‚
â”‚ Juin       â”‚       0â‚¬ â”‚ 125 000â‚¬ â”‚ 125 000â‚¬ â”‚      0â‚¬   â”‚ â³ Futurâ”‚
â”‚ ...        â”‚      ... â”‚      ... â”‚      ... â”‚      ...  â”‚    ...  â”‚
â”‚ DÃ©cembre   â”‚       0â‚¬ â”‚ 125 000â‚¬ â”‚ 125 000â‚¬ â”‚      0â‚¬   â”‚ â³ Futurâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**LÃ©gende**:
- âœ… **PassÃ©**: Montants rÃ©alisÃ©s depuis `journal_entries`
- ğŸ”µ **En cours**: RÃ©el + Prorata du budget
- â³ **Futur**: Budget complet

## ğŸ”§ FonctionnalitÃ©s SupplÃ©mentaires

### Bouton "RafraÃ®chir"
- Recharge les donnÃ©es en temps rÃ©el
- Utile aprÃ¨s ajout d'Ã©critures comptables

### Mode de Calcul
SÃ©lecteur avec 2 options:
- **Prorata**: Budget Ã— (jour_actuel / jours_dans_mois)
- **Run Rate**: BasÃ© sur la tendance actuelle

### Export CSV
- Bouton pour tÃ©lÃ©charger le forecast
- Format CSV pour Excel/Google Sheets

### Ã‰critures Non MappÃ©es
Si des Ã©critures comptables ne sont pas associÃ©es Ã  une catÃ©gorie budgÃ©taire, un bandeau d'alerte s'affiche:

```
âš ï¸ Attention: 15 Ã©critures comptables (45 000â‚¬) ne sont pas mappÃ©es
â”‚ Compte 706000: 25 000â‚¬ (10 Ã©critures)
â”‚ Compte 641200: 15 000â‚¬ (3 Ã©critures)
â”‚ Compte 613100:  5 000â‚¬ (2 Ã©critures)
```

## âš™ï¸ Configuration Requise (pour l'admin)

### 1. CrÃ©er des Budgets
- Aller dans "Budgets" > "Nouveau Budget"
- DÃ©finir les catÃ©gories (Revenus, Charges, Investissements)
- Saisir les montants mensuels

### 2. Mapper les Comptes Comptables
**IMPORTANT**: Pour que le forecast fonctionne, il faut associer les comptes comptables aux catÃ©gories budgÃ©taires.

Exemple de mapping Ã  crÃ©er en SQL:

```sql
INSERT INTO category_account_map (company_id, category_id, account_code)
VALUES
  -- Revenus
  ('votre-company-id', 'category-ventes-id', '706000'),
  ('votre-company-id', 'category-ventes-id', '707000'),

  -- Charges
  ('votre-company-id', 'category-salaires-id', '641000'),
  ('votre-company-id', 'category-salaires-id', '645000'),
  ('votre-company-id', 'category-loyers-id', '613000');
```

### 3. Avoir des Ã‰critures Comptables
- Les Ã©critures doivent avoir le statut `posted` (validÃ©es)
- Elles doivent Ãªtre dans `journal_entries` + `journal_entry_lines`

## ğŸ¨ Navigation

**Retour Ã  la liste**: Bouton "â† Retour Ã  la liste" en haut Ã  gauche

## ğŸ“± Responsive

Le forecast fonctionne sur:
- ğŸ’» Desktop
- ğŸ“± Tablette
- ğŸ“± Mobile (vue adaptÃ©e)

## ğŸŒ™ Mode Sombre

Tout l'interface du forecast est compatible avec le mode sombre de l'application.

## ğŸš¨ DÃ©pannage

**ProblÃ¨me**: Le bouton "Forecast" n'apparaÃ®t pas
- âœ… VÃ©rifier que la migration SQL a Ã©tÃ© appliquÃ©e
- âœ… VÃ©rifier que `onViewForecast` est bien passÃ© dans `BudgetManager`

**ProblÃ¨me**: Le forecast affiche "0â‚¬" partout
- âœ… VÃ©rifier qu'il y a des Ã©critures comptables avec `status = 'posted'`
- âœ… VÃ©rifier que les mappings `category_account_map` existent
- âœ… VÃ©rifier que les comptes correspondent

**ProblÃ¨me**: Erreur au chargement
- âœ… Ouvrir la console (F12) pour voir l'erreur
- âœ… VÃ©rifier que les fonctions SQL existent: `get_budget_forecast`, `get_budget_forecast_kpi`

---

*Pour toute question technique, consulter `BUDGET_FORECAST_READY.md`*
